<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Genymotion 安卓模拟器 | Mr and Mrs li</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="个人博客站，分享个人学习笔记个人生活记录。">
    <link rel="preload" href="/assets/css/0.styles.8985c895.css" as="style"><link rel="preload" href="/assets/js/app.67f99543.js" as="script"><link rel="preload" href="/assets/js/2.4bf6c67a.js" as="script"><link rel="preload" href="/assets/js/11.108e04c9.js" as="script"><link rel="prefetch" href="/assets/js/10.0d2e3a77.js"><link rel="prefetch" href="/assets/js/12.8b89975f.js"><link rel="prefetch" href="/assets/js/13.4d037f62.js"><link rel="prefetch" href="/assets/js/14.122a630d.js"><link rel="prefetch" href="/assets/js/15.8fae0d13.js"><link rel="prefetch" href="/assets/js/16.2e90f560.js"><link rel="prefetch" href="/assets/js/17.c85dce0e.js"><link rel="prefetch" href="/assets/js/18.9956a868.js"><link rel="prefetch" href="/assets/js/19.7053447a.js"><link rel="prefetch" href="/assets/js/3.1a6329e4.js"><link rel="prefetch" href="/assets/js/4.c879697a.js"><link rel="prefetch" href="/assets/js/5.f1984629.js"><link rel="prefetch" href="/assets/js/6.3e320468.js"><link rel="prefetch" href="/assets/js/7.909d630b.js"><link rel="prefetch" href="/assets/js/8.7f8c97df.js"><link rel="prefetch" href="/assets/js/9.79f2d8ef.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8985c895.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mr and Mrs li</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/videos/" class="nav-link">
  Video
</a></div><div class="nav-item"><a href="/photos/" class="nav-link">
  Photo
</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  Blog
</a></div> <a href="https://github.com/lixinxingwork/myvuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/videos/" class="nav-link">
  Video
</a></div><div class="nav-item"><a href="/photos/" class="nav-link">
  Photo
</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  Blog
</a></div> <a href="https://github.com/lixinxingwork/myvuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/blog/" aria-current="page" class="sidebar-link">工作导航页</a></li><li><a href="/blog/flask.html" class="sidebar-link">Flask</a></li><li><a href="/blog/genymotion.html" aria-current="page" class="active sidebar-link">Genymotion 安卓模拟器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/genymotion.html#获取imei-imei-py" class="sidebar-link">获取IMEI imei.py</a></li><li class="sidebar-sub-header"><a href="/blog/genymotion.html#获取androidid-androidid-py" class="sidebar-link">获取AndroidID androidID.py</a></li><li class="sidebar-sub-header"><a href="/blog/genymotion.html#辅助功能-localtime-py" class="sidebar-link">辅助功能 localtime.py</a></li><li class="sidebar-sub-header"><a href="/blog/genymotion.html#执行脚本-processgenymotion-py" class="sidebar-link">执行脚本 processGenymotion.py</a></li></ul></li><li><a href="/blog/makdown.html" class="sidebar-link">makdown</a></li><li><a href="/blog/python.html" class="sidebar-link">Python 的应用实例</a></li><li><a href="/blog/verynginx.html" class="sidebar-link">Verynginx</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="genymotion-安卓模拟器">Genymotion 安卓模拟器</h1> <h2 id="获取imei-imei-py">获取IMEI imei.py</h2> <p>一款基于genymotion的安卓模拟器的python调用，操作方法。本文介绍了使用adb调用，对apk进行安装，启动，卸载，并且实现了模拟器的IMEI和AndroidID的自动获取和修改。每次启动apk时，模拟器的IMEI和AndroidID都已被修改，模拟新终端用户下载和登陆app。</p> <div class="language- extra-class"><pre class="language-text"><code>#!/usr/bin/python 
# -*- coding: UTF-8 -*- 
import random,os

def genImeiLuhn(digits14): 
    digit15=0 
    for num in range(14): 
        if num%2==0: 
            digit15=digit15+int(digits14[num]) 
        else: 
            digit15=digit15+(int(digits14[num])*2)%10+(int(digits14[num])*2)/10 
    digit15=int(digit15)%10 
    # 组装14位数字+生成的1位
    # 第四部分 CD，Check Digit，验证码，由前14位数字通过 Luhn算法计算得出。
    if digit15==0: 
        digits14=digits14+str(digit15) 
    else: 
        digits14=digits14+str(10-digit15) 
    return digits14 
# 批量
def genMassImei(amount,filepath): 
    fo=open(filepath,&quot;wb&quot;) 
    for num in range(amount): 
        stat14digits=genRandomNumer(14)
        imei=genImeiLuhn(stat14digits) 
        fo.write(imei+&quot;\r\n&quot;) 
        print imei
    fo.flush() 
    fo.close()
# 单个
def genMassImei_one(): 
    stat14digits=genRandomNumer(14)
    imei=genImeiLuhn(stat14digits)
    # print imei 
    return imei
    

def genRandomNumer(Num):
    number=''.join(str(random.choice(range(10))) for _ in range(Num))
    return number

if __name__ == '__main__':   
    # genMassImei(100,&quot;imei2.txt&quot;)
    genMassImei_one
    print genMassImei_one()
</code></pre></div><h2 id="获取androidid-androidid-py">获取AndroidID androidID.py</h2> <div class="language- extra-class"><pre class="language-text"><code>#!/usr/bin/env python
#-*- coding:utf-8 -*-
import  hashlib,binascii,random

def sha1_hash(data):
    '''
    param input type: str
    param output type: bytes
    '''
    return hashlib.sha1(data.encode('ascii')).digest()

def generate_device_id(steamid_sha1_hash):
    '''
    param input type: bytes
    param output type: str
    '''
    h = binascii.hexlify(steamid_sha1_hash).decode('ascii')      #码流转换
    return &quot;%s%s%s&quot; % (h[:8], h[8:12], h[12:16])    

if __name__==&quot;__main__&quot;:
    steamid_sha1_hash = sha1_hash(&quot;123123312312312&quot;)
    # print(steamid_sha1_hash)
    deviceid = generate_device_id(steamid_sha1_hash)
    print(deviceid)
</code></pre></div><h2 id="辅助功能-localtime-py">辅助功能 localtime.py</h2> <div class="language- extra-class"><pre class="language-text"><code>import datetime
def getYesterday(): 
    today=datetime.date.today() 
    oneday=datetime.timedelta(days=1) 
    yesterday=today-oneday  
    return yesterday

if __name__==&quot;__main__&quot;:
    print getYesterday()
</code></pre></div><h2 id="执行脚本-processgenymotion-py">执行脚本 processGenymotion.py</h2> <div class="language- extra-class"><pre class="language-text"><code>#!/usr/bin/python 
# -*- coding: UTF-8 -*- 
import os,time,random,sys
from imei import genMassImei_one
from androidID import sha1_hash,generate_device_id

def startGenymotion(Name):
    Bool=os.popen(&quot;ps -ef|grep %s|grep player|grep -v grep|wc -l&quot; % (Name)).readlines()[0]
    if Bool[0]=='0':
        os.system(&quot;nohup /opt/genymobile/genymotion/player --vm-name %s &gt;/dev/null 2&gt;&amp;1 &amp;&quot; % (Name))
        time.sleep(30)
    else:
        print(&quot;the virtual box %s is still alive&quot; % (Name))
        pass

def genymotionShell(Imei,androidID):
    GENYMOTION_ID=os.popen(&quot;/opt/genymobile/genymotion/tools/adb  devices|grep -n 5555|awk -F: '{print $2}'|head -n 2|awk END'{print}'&quot;).readlines()[0].replace(&quot;\n&quot;,&quot;&quot;)
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell settings put secure android_id %s&quot; % (GENYMOTION_ID,androidID))
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell setprop persist.gsm.imei %s&quot; % (GENYMOTION_ID,Imei))
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell setprop genymotion.device.id %s&quot; % (GENYMOTION_ID,Imei))
    os.system(&quot;timeout 10 /opt/genymobile/genymotion/tools/adb -s %s:5555 install ~/genymotion_autostartapp/com.lf.ccdapp.apk&quot; % (GENYMOTION_ID))
    time.sleep(3)
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell am start -n com.lf.ccdapp/com.lf.ccdapp.model.login.activity.SplashActivity&quot; % (GENYMOTION_ID))
    time.sleep(3)
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell input tap 162 226&quot; % (GENYMOTION_ID))
    # time.sleep(3)
    # os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell shell am force-stop com.lf.ccdapp&quot; % (GENYMOTION_ID))
    time.sleep(2)
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 uninstall com.lf.ccdapp&quot; % (GENYMOTION_ID))

def curlUrl(URL):
    GENYMOTION_ID=os.popen(&quot;/opt/genymobile/genymotion/tools/adb  devices|grep -n 5555|awk -F: '{print $2}'|head -n 2|awk END'{print}'&quot;).readlines()[0].replace(&quot;\n&quot;,&quot;&quot;)
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell setprop persist.gsm.imei %s&quot; % (GENYMOTION_ID,Imei))
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell am start -a android.intent.action.VIEW -d %s&quot; % (GENYMOTION_ID,URL))
    time.sleep(6)
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell input tap 127 147&quot; % (GENYMOTION_ID))
    WaitTime=random.randint(3,9)
    print(&quot;wait time %s&quot; % (WaitTime))
    time.sleep(WaitTime)
    os.system(&quot;timeout 5 /opt/genymobile/genymotion/tools/adb -s %s:5555 shell am force-stop com.android.browser&quot; % (GENYMOTION_ID))

if __name__==&quot;__main__&quot;:
    # 获取数量在配置文件~/genymotion_autostartapp/bin/shualiang.conf
    amount=os.popen(&quot;head -n `date +%d` ~/genymotion_autostartapp/bin/shualiang.conf|tail -n 1&quot;).readlines()[0]
    # log日志文件配置
    Time_day = time.strftime(&quot;%Y-%m-%d&quot;, time.localtime())
    PWD=sys.path[0]
    fo=open(PWD+&quot;/log/&quot;+Time_day+&quot;imei.log&quot;,&quot;ab&quot;) 

    for num in range(int(amount)):
        # 获取androidID
        dg_number=str(random.randint(1,999999999))
        steamid_sha1_hash = sha1_hash(dg_number)
        # print(steamid_sha1_hash)
        deviceid = generate_device_id(steamid_sha1_hash)
        # 获取IMEI
        Imei = genMassImei_one()
        # 启动虚拟机
        startGenymotion('ccd01')
        # 执行流程
        genymotionShell(Imei,deviceid)
        # 写日志
        Time = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime())
        fo.write(Time+&quot; IMEI: &quot;+Imei+ &quot; AndroidID &quot;+deviceid+&quot;\r\n&quot;)
        fo.flush() 
    fo.close()

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/lixinxingwork/myvuepress/edit/theme-defalut/docs/blog/genymotion.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/flask.html" class="prev">
        Flask
      </a></span> <span class="next"><a href="/blog/makdown.html">
        makdown
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.67f99543.js" defer></script><script src="/assets/js/2.4bf6c67a.js" defer></script><script src="/assets/js/11.108e04c9.js" defer></script>
  </body>
</html>
